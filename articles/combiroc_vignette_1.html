<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="combiroc">
<title>Guide to CombiROC package - Standard workflow • combiroc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Guide to CombiROC package - Standard workflow">
<meta property="og:description" content="combiroc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">combiroc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/combiroc_vignette_1.html">Standard Workflow</a>
    <a class="dropdown-item" href="../articles/combiroc_vignette_2.html">SingleCell Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ingmbioinfo/combiroc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Guide to CombiROC package - Standard workflow</h1>
            <h3 data-toc-skip class="subtitle"><div class="line-block">Selection and ranking of omics biomarkers
combinations made easy.</div></h3>
                        <h4 data-toc-skip class="author">Ivan Ferrari,
Riccardo L. Rossi</h4>
            
            <h4 data-toc-skip class="date">03 July 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ingmbioinfo/combiroc/blob/HEAD/vignettes/combiroc_vignette_1.Rmd" class="external-link"><code>vignettes/combiroc_vignette_1.Rmd</code></a></small>
      <div class="d-none name"><code>combiroc_vignette_1.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="top">Summary<a class="anchor" aria-label="anchor" href="#top"></a>
</h2>
<p>Powerful biomarkers are important tools in diagnostic, clinical and
research settings. In the area of diagnostic medicine, a biomarker is
often used as a tool to identify subjects with a disease, or at high
risk of developing a disease. Moreover, it can be used to foresee the
more likely outcome of the disease, monitor its progression and predict
the response to a given therapy. Diagnostic accuracy can be improved
considerably by combining multiple markers, whose performance in
identifying diseased subjects is usually assessed via receiver operating
characteristic (ROC) curves. The CombiROC tool was originally designed
as an easy to use R-Shiny web application to determine optimal
combinations of markers from diverse complex omics data ( <a href="https://www.nature.com/articles/srep45477" class="external-link">Mazzara et al. 2017</a>
); such an implementation is easy to use but has limited features and
limitations arise from the machine it is deployed on. The CombiROC
<em>package</em> is the natural evolution of the CombiROC tool and it
allows the researcher/analyst to freely use the method and further build
on it.</p>
</div>
<div class="section level2">
<h2 id="the-complete-workflow">The complete workflow<a class="anchor" aria-label="anchor" href="#the-complete-workflow"></a>
</h2>
<p>The aim of this document is to show the whole CombiROC workflow for
biomarkers analysis to get you up and running as quickly as possible
with this package. To do so we’re going to use the proteomic dataset
from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3518104/" class="external-link">Zingaretti
et al. 2012</a> containing multi-marker signatures for Autoimmune
Hepatitis (AIH) for samples clinically diagnosed as “abnormal” (class A)
or “normal” (class B). The scope of the workflow is to first find the
markers combinations, then to assess their performance in classifying
samples of the dataset.</p>
<p><strong>Note:</strong> if you use CombiROC in your research, please
cite:</p>
<blockquote>
<p>Mazzara S., Rossi R.L., Grifantini R., Donizetti S., Abrignani L.,
Bombaci M. (2017) CombiROC: an interactive web tool for selecting
accurate marker combinations of omics data. <em>Scientific Reports</em>,
<strong>7</strong>:45477. <a href="https://doi.org/10.1038/srep45477" class="external-link">10.1038/srep45477</a></p>
</blockquote>
<div class="section level3">
<h3 id="format">Required data format<a class="anchor" aria-label="anchor" href="#format"></a>
</h3>
<p>The dataset to be analysed should be in text format, which can be
separated by commas, tabs or semicolons. Format of the columns should be
the following:</p>
<ul>
<li>The 1st column must contain unique patient/sample IDs.</li>
<li>The 2nd column must contain the class to which each sample
belongs.</li>
<li>The classes <strong>must</strong> be exactly TWO and they
<strong>must be labelled with character format with “A”</strong>
(usually the cases) <strong>and “B”</strong> (usually the
controls).</li>
<li>From the 3rd column on, the dataset must contain numerical values
that represent the signal corresponding to the markers abundance in each
sample (marker-related columns).</li>
<li>The header for marker-related columns can be called ‘Marker1,
Marker2, Marker3, …’ or can be called directly with the gene/protein
name. <strong>Please note</strong> that “-” (dash) is
<strong>not</strong> allowed in the column names</li>
</ul>
</div>
<div class="section level3">
<h3 id="load">Data loading<a class="anchor" aria-label="anchor" href="#load"></a>
</h3>
<p>The <code><a href="../reference/load_data.html">load_data()</a></code> function uses a customized
<strong>read.table()</strong> function that checks the conformity of the
dataset format. If all the checks are passed, marker-related columns are
reordered alphabetically, depending on marker names (this is necessary
for a proper computation of combinations), and it imposes “Class” as the
name of the second column. The loaded dataset is here assigned to the
“<em>data</em>” object. Please note that <code><a href="../reference/load_data.html">load_data()</a></code> takes
the semicolumn (“;”) as default separator: if the dataset to be loaded
has a different separator, i.e. a comma (“,”), is necessary to specify
it in the argument <code>sep</code>. The code below shows how to load a
data set contained in the “data” folder (remember to adjust the path
according to your current working directory).</p>
<p>First of all, load the package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ingmbioinfo/combiroc" class="external-link">combiroc</a></span><span class="op">)</span></span></code></pre></div>
<p>Then load the data. To do so you can use the function
<code><a href="../reference/load_data.html">load_data()</a></code> if you have a correctly formatted dataset
ready:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data.html">load_data</a></span><span class="op">(</span><span class="st">"./data/demo_data.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Now, we are going to use an AIH demo data set, that has been included
in CombiROC package and can be directly called as
<code>demo_data</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">demo_data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Patient.ID Class Marker1 Marker2 Marker3 Marker4 Marker5</span></span>
<span><span class="co">## 1       AIH1     A     438     187     197     298     139</span></span>
<span><span class="co">## 2       AIH2     A     345     293     134     523     335</span></span>
<span><span class="co">## 3       AIH3     A     903     392     300    1253       0</span></span>
<span><span class="co">## 4       AIH4     A     552     267     296     666      22</span></span>
<span><span class="co">## 5       AIH5     A    1451     760     498     884     684</span></span>
<span><span class="co">## 6       AIH6     A     497     260     175     640     572</span></span></code></pre>
<p>NB: combiroc is able to deal with missing values both by removing the
samples with NA values or imputing the values given the median signal of
the class (see ?roc_reports() deal_NA parameter). combiroc is not meant
to work with negative values. We recommend to preprocess the data in
order to have for all the markers, and for all the sample, a numeric
signal values higher or equal to 0 BEFORE using combiroc.</p>
</div>
<div class="section level3">
<h3 id="exploring-the-data">Exploring the data<a class="anchor" aria-label="anchor" href="#exploring-the-data"></a>
</h3>
<p>It is usually a good thing to visually explore your data with at
least a few plots.<br>
Box plots are a nice option to observe the distribution of measurements
in each sample. The user can plot the data as she/he wishes using the
preferred function: since data for CombiROC are required to be in
<em>wide</em> (<em>untidy</em>) format, they cannot be plotted directly
with the widely used <code>ggplot()</code> function. Either the user is
free to make the data longer (<em>tidy</em>) for the sole purpose of
plotting, or the package’s <code><a href="../reference/combiroc_long.html">combiroc_long()</a></code> function can be
used for this purpose; this function wraps the
<code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer()</a></code>function, and it’s used to reshape the
data in long format.</p>
<p>Data in long format are required for the plotting functions of the
package and for any other Tidyverse-oriented applications.</p>
<p>The <strong>data</strong> object in the original wide format can be
thus transformed into the reshaped long format
<strong>data_long</strong> object, and further used.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combiroc_long.html">combiroc_long</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">data_long</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 850 × 4</span></span></span>
<span><span class="co">##    Patient.ID Class Markers Values</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> AIH1       A     Marker1    438</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> AIH1       A     Marker2    187</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> AIH1       A     Marker3    197</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> AIH1       A     Marker4    298</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> AIH1       A     Marker5    139</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> AIH2       A     Marker1    345</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> AIH2       A     Marker2    293</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> AIH2       A     Marker3    134</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> AIH2       A     Marker4    523</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> AIH2       A     Marker5    335</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 840 more rows</span></span></span></code></pre>
<div class="section level4">
<h4 id="checking-the-individual-markers">Checking the individual markers<a class="anchor" aria-label="anchor" href="#checking-the-individual-markers"></a>
</h4>
<p>Individual markers can also be explored retrieving a summary
statistics and all individual scatter plots. To do so, the function
<code><a href="../reference/single_markers_statistics.html">single_markers_statistics()</a></code> can be used ingesting the
dataframe <code>data_long</code> in long format returned by
<code><a href="../reference/combiroc_long.html">combiroc_long()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single_markers_statistics.html">single_markers_statistics</a></span><span class="op">(</span><span class="va">data_long</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/single_markers_statistics.html">single_markers_statistics()</a></code> function returns a list
on length 2, whose first element (<code>sms[[1]]</code>) is a table with
statistics for all markers in each class. The computed statistics
are:</p>
<ul>
<li>mean value</li>
<li>minimum and maximum values</li>
<li>stadard deviation</li>
<li>coefficient of variation</li>
<li>first quartile limit, median, third quartile limit</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_table</span> <span class="op">&lt;-</span> <span class="va">sms</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">s_table</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 11</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   Markers [5]</span></span></span>
<span><span class="co">##    Markers Class   Mean   Min   Max     Sd    CV First_Quart. Median</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Marker1 A     <span style="text-decoration: underline;">1</span>159.     52  <span style="text-decoration: underline;">8</span>584 <span style="text-decoration: underline;">1</span>672.  1.44         369.   569  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Marker1 B      161.      0  <span style="text-decoration: underline;">1</span>223  162.  1.01          59.5  111  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Marker2 A      692.     41  <span style="text-decoration: underline;">3</span>704  783.  1.13         259    422. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Marker2 B      141.      0  <span style="text-decoration: underline;">2</span>142  205.  1.45          55.2  100. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Marker3 A      767.      0 <span style="text-decoration: underline;">13</span>178 <span style="text-decoration: underline;">2</span>436.  3.18          73.2  189  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Marker3 B       56.2     0   640   80.6 1.43          10.2   33.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Marker4 A      879.    105  <span style="text-decoration: underline;">3</span>390  713.  0.811        371    620. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Marker4 B      467.      0  <span style="text-decoration: underline;">2</span>464  406.  0.869        232    361  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Marker5 A      571.      0  <span style="text-decoration: underline;">2</span>757  582.  1.02         152.   518  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Marker5 B      205.      0  <span style="text-decoration: underline;">4</span>114  413.  2.02          17.2   76  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2 more variables: Third_Quart. &lt;dbl&gt;, Skewness &lt;dbl&gt;</span></span></span></code></pre>
<p>While the second element is another list, containing dot plots, one
for each marker. The individual plots can be called from the second
element (<code>sms[[2]]</code>) of the list with the <code>$</code>
operator. Here we display the plot for Marker 1:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_m1</span> <span class="op">&lt;-</span> <span class="va">sms</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Marker1</span></span>
<span><span class="va">plot_m1</span></span></code></pre></div>
<p><img src="combiroc_vignette_1_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>In the section <a href="#snipp">“Code snippets”</a> at the end of
this vignette we suggest code snippets that can be used to <a href="#plot_int">customize the plots for individual markers</a> across
all samples, as well as to <a href="#sum_stats">modify the summary
statistics</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="distr">Markers distribution overview<a class="anchor" aria-label="anchor" href="#distr"></a>
</h3>
<p>Since the target of the analysis is the identification of marker
combinations capable to correctly classify samples, the user should
first choose a signal threshold to define the positivity for a given
marker/combination. This threshold should:</p>
<ul>
<li>Positively select most samples belonging to the case class (labelled
with “A” in the “Class” column of the dataset), which values must be
above the signal threshold.</li>
<li>Negatively select most control samples (labelled “B”), which values
must be below the signal threshold.</li>
</ul>
<p>Usually this threshold is suggested by the guidelines of the kit used
for the analysis (e.g. mean of buffer signal + n standard deviations).
However, it is a good practice to always check the distribution of
signal intensity of the dataset. To help the user with this operation,
the <code><a href="../reference/markers_distribution.html">markers_distribution()</a></code> function have been implemented
generating a set of discoverable objects.</p>
<p>This function takes as input the data in long format (
<strong>data_long</strong> ), and returns a named list (here assigned to
the <strong>distr</strong> object). Please note that the only required
argument of <code>markers_distributions()</code> function is
<code>case_class</code>, while other arguments have defaults: specific
warnings are triggered with this command remembering the users the
default threshold parameters that are in place during the
computation.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/markers_distribution.html">markers_distribution</a></span><span class="op">(</span><span class="va">data_long</span>, case_class <span class="op">=</span> <span class="st">'A'</span>, </span>
<span>                              y_lim <span class="op">=</span> <span class="fl">0.0015</span>, x_lim <span class="op">=</span> <span class="fl">3000</span>, </span>
<span>                              signalthr_prediction <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                              min_SE <span class="op">=</span> <span class="fl">40</span>, min_SP <span class="op">=</span> <span class="fl">80</span>, </span>
<span>                              boxplot_lim <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in markers_distribution(data_long, case_class = "A", y_lim = 0.0015, :</span></span>
<span><span class="co">## The suggested signal threshold in $Plot_density is the threshold with the</span></span>
<span><span class="co">## highest Youden index of the signal thresholds at which SE&gt;=min_SE and</span></span>
<span><span class="co">## SP&gt;=min_SP. This is ONLY a suggestion. Please check if signal threshold is</span></span>
<span><span class="co">## suggested by your analysis kit guidelines instead, and remember to check</span></span>
<span><span class="co">## $Plot_density to better judge our suggested threshold by inspecting the 2</span></span>
<span><span class="co">## distributions.</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-distr-object">The <strong>distr</strong> object<a class="anchor" aria-label="anchor" href="#the-distr-object"></a>
</h3>
<p>The <strong>distr</strong> object contains the following
elements:</p>
<ul>
<li>a Boxplot distribution of all single markers</li>
<li>a ROC curve for all markers</li>
<li>the above curve’s coordinates</li>
<li>a density plot for case and control classes</li>
<li>a summary with a few statistics.</li>
</ul>
<p>Once the <code>markers_distributions()</code> function is run, all
the above elements can be plotted or displayed individually. Let’s see
each one of them</p>
<div class="section level4">
<h4 id="boxplot">Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"></a>
</h4>
<p>The <strong>Boxplot</strong> shows the distribution of each marker
values for both classes:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distr</span><span class="op">$</span><span class="va">Boxplot</span></span></code></pre></div>
<p><img src="combiroc_vignette_1_files/figure-html/boxplot-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="the-roc-curve-for-all-markers-and-its-coordinates">The ROC curve for all markers and its coordinates<a class="anchor" aria-label="anchor" href="#the-roc-curve-for-all-markers-and-its-coordinates"></a>
</h4>
<p>The <strong>ROC</strong> curve shows how many real positive samples
would be found positive (sensitivity, or SE) and how many real negative
samples would be found negative (specificity, or SP) in function of
signal threshold. Please note that the <em>False Positive Rate</em>
(i.e. <em>1 - specificity</em>) is plotted on the x-axis. These SE and
SP are refereed to the signal intensity threshold considering
<em>all</em> the markers together; they are <em>not</em> the SE and SP
of a single marker/combination computed by the ’combi()` function
further discussed in the <strong>Combinatorial analyisis, sensitivity
and specificity</strong> paragraph.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distr</span><span class="op">$</span><span class="va">ROC</span></span></code></pre></div>
<p><img src="combiroc_vignette_1_files/figure-html/ROC-1.png" width="700"></p>
<p>The <strong>Coord</strong> is a dataframe that contains the
coordinates of the above described “ROC” (threshold, SP and SE) that
have at least a minimun SE (min_SE) and a minimum SP (min_SP): this two
threshold are set by default at <code>min_SE = 0</code> and
<code>min_SP = 0</code>, but they can be set manually by specifying
different values as shown in the example. The Youden index is also
computed: this is the Youden’s J statistic capturing the performance of
a dichotomous diagnostic test, with higher values for better performance
( <span class="math inline">\(J = SE + SP -1\)</span>).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">distr</span><span class="op">$</span><span class="va">Coord</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     threshold specificity sensitivity    Youden</span></span>
<span><span class="co">## 240     319.5          80          65 0.4500000</span></span>
<span><span class="co">## 241     320.5          80          65 0.4515385</span></span>
<span><span class="co">## 242     322.0          80          65 0.4530769</span></span>
<span><span class="co">## 243     325.0          80          65 0.4546154</span></span>
<span><span class="co">## 244     327.5          81          65 0.4561538</span></span>
<span><span class="co">## 245     328.5          81          65 0.4576923</span></span>
<span><span class="co">## 246     329.5          81          64 0.4526923</span></span>
<span><span class="co">## 247     331.0          81          64 0.4426923</span></span>
<span><span class="co">## 248     332.5          81          64 0.4488462</span></span>
<span><span class="co">## 249     334.0          82          64 0.4503846</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="dens">The density plot and suggested signal threshold<a class="anchor" aria-label="anchor" href="#dens"></a>
</h4>
<p>The <strong>Density_plot</strong> shows the distribution of the
signal intensity values for both the classes. In addition, the function
allows the user to set both the y_lim and x_lim values to provide a
better visualization. One important feature of the density plot is that
it calculates a possible <strong>signal intensity threshold:</strong> in
case of lack of <em>a priori</em> knowedge of the threshold the user can
set the argument <code>signalthr_prediction = TRUE</code> in the
<code><a href="../reference/markers_distribution.html">markers_distribution()</a></code> function. In this way the function
calculates a “suggested signal threshold” that corresponds to the signal
threshold value associated to the highest Youden index (in
<strong>Coord</strong>), at which SE and SP are greater or equal to
their set minimal values (min_SE and min_SP). This threshold is added to
the “Density_plot” object as a dashed black line and a number. The use
of the Youden index allows to pick a threshold with the best SE/SP
setting, but it is recommended to always inspect “Coord” and choose the
most appropriate signal threshold by considering SP, SE and Youden
index.</p>
<p>This suggested signal threshold can be used as
<strong>signalthr</strong> argument of the <code><a href="../reference/combi.html">combi()</a></code> function
further in the workflow.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distr</span><span class="op">$</span><span class="va">Density_plot</span></span></code></pre></div>
<p><img src="combiroc_vignette_1_files/figure-html/density-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="the-density-summary">The density summary<a class="anchor" aria-label="anchor" href="#the-density-summary"></a>
</h4>
<p>Finally, the <strong>Density_summary</strong> displays a few summary
statistics of the density plot.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distr</span><span class="op">$</span><span class="va">Density_summary</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">##   Class `# observations`   Min   Max Median  Mean `1st Q` `3rd Q`    SD</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> A                  200     0 <span style="text-decoration: underline;">13</span>178    461  814.    233.     825 <span style="text-decoration: underline;">1</span>427.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> B                  650     0  <span style="text-decoration: underline;">4</span>114    106  206.     38      266  318.</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="combi">Combinatorial analysis, sensitivity and specificity<a class="anchor" aria-label="anchor" href="#combi"></a>
</h3>
<p><code><a href="../reference/combi.html">combi()</a></code> function works on the dataset initially loaded.
It computes the marker combinations and counts their corresponding
positive samples for each class (once thresholds are selected). A
sample, to be considered positive for a given combination, must have a
value higher than a given signal threshold (signalthr) for at least a
given number of markers composing that combination (combithr).</p>
<p>As mentioned before, <code>signalthr</code> should be set depending
on the guidelines and characteristics of the methodology used for the
analysis or by an accurate inspection of signal intensity distribution.
In case of lack of specific guidelines, one should set the value
<code>signalthr</code> as suggested by the
<code>distr$Density_plot</code> as described in the previous
section.</p>
<p>In this vignette <code>signalthr</code> is set at
<strong>450</strong> while <code>combithr</code> is set at
<strong>1</strong>. We are setting this at 450 (instead of
<strong>328.5</strong> as suggested by the
<code>distr$Density_plot</code>) in order to reproduce the results
reported in <a href="https://www.nature.com/articles/srep45477" class="external-link">Mazzara
et. al 2017</a> (the original CombiROC paper) or in <a href="https://doi.org/10.1007/978-1-4939-9164-8_16" class="external-link">Bombaci &amp; Rossi
2019</a> as well as in the tutorial of the web app with default
thresholds.</p>
<p><code>combithr</code>, instead, should be set exclusively depending
on the needed stringency: <strong>1</strong> is the less stringent and
most common choice (meaning that <em>at least one</em> marker in a
combination needs to reach the threshold).</p>
<p>Once all the combinations are computed, the function calculates:</p>
<ul>
<li>Sensitivity (SE) and specificity (SP) of each combination for each
class;</li>
<li>the number of markers composing each combination (n_markerrs).</li>
</ul>
<p>SE of is calculated dividing the number of detected positive samples
for case class by the total sample of case class (% of positive “A”
samples).</p>
<p>SP of control class (“B”) is calculated by subtracting the percentage
of positive samples for control class in the total sample of control
class to 100 (100 - % of positive “B” samples).</p>
<p>NB: with <code>max_length</code> is possible to set the maximum
number of markers allowed to compose a combination (in the example the
computed combinations will be composed at most by 3 markers instead of
5). This parameter can be very useful in case of a huge number of
markers (e.g. &gt;20) in order to drastically reduce the number of
possible combinations, making the calculation computationally more
manageable by removing the longest ones (less important from the
diagnostic point of view).</p>
<p>The obtained <strong>tab</strong> object is a dataframe of all the
combinations obtained with the chosen parameters, the obtained value of
SE, SP and number of markers.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combi.html">combi</a></span><span class="op">(</span><span class="va">data</span>, signalthr <span class="op">=</span> <span class="fl">450</span>, combithr <span class="op">=</span> <span class="fl">1</span>, case_class<span class="op">=</span><span class="st">'A'</span>, max_length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tab</span>, n<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                Markers #Positives A #Positives B   SE       SP</span></span>
<span><span class="co">## Marker1                        Marker1           26            6 65.0 95.38462</span></span>
<span><span class="co">## Marker2                        Marker2           19            2 47.5 98.46154</span></span>
<span><span class="co">## Marker3                        Marker3            8            1 20.0 99.23077</span></span>
<span><span class="co">## Marker4                        Marker4           26           48 65.0 63.07692</span></span>
<span><span class="co">## Marker5                        Marker5           23           15 57.5 88.46154</span></span>
<span><span class="co">## Combination 1          Marker1-Marker2           29            6 72.5 95.38462</span></span>
<span><span class="co">## Combination 2          Marker1-Marker3           29            6 72.5 95.38462</span></span>
<span><span class="co">## Combination 3          Marker1-Marker4           31           52 77.5 60.00000</span></span>
<span><span class="co">## Combination 4          Marker1-Marker5           30           21 75.0 83.84615</span></span>
<span><span class="co">## Combination 5          Marker2-Marker3           21            2 52.5 98.46154</span></span>
<span><span class="co">## Combination 6          Marker2-Marker4           32           50 80.0 61.53846</span></span>
<span><span class="co">## Combination 7          Marker2-Marker5           28           17 70.0 86.92308</span></span>
<span><span class="co">## Combination 8          Marker3-Marker4           29           49 72.5 62.30769</span></span>
<span><span class="co">## Combination 9          Marker3-Marker5           27           16 67.5 87.69231</span></span>
<span><span class="co">## Combination 10         Marker4-Marker5           31           53 77.5 59.23077</span></span>
<span><span class="co">## Combination 11 Marker1-Marker2-Marker3           31            6 77.5 95.38462</span></span>
<span><span class="co">## Combination 12 Marker1-Marker2-Marker4           34           52 85.0 60.00000</span></span>
<span><span class="co">## Combination 13 Marker1-Marker2-Marker5           33           21 82.5 83.84615</span></span>
<span><span class="co">## Combination 14 Marker1-Marker3-Marker4           34           52 85.0 60.00000</span></span>
<span><span class="co">## Combination 15 Marker1-Marker3-Marker5           33           21 82.5 83.84615</span></span>
<span><span class="co">##                n_markers</span></span>
<span><span class="co">## Marker1                1</span></span>
<span><span class="co">## Marker2                1</span></span>
<span><span class="co">## Marker3                1</span></span>
<span><span class="co">## Marker4                1</span></span>
<span><span class="co">## Marker5                1</span></span>
<span><span class="co">## Combination 1          2</span></span>
<span><span class="co">## Combination 2          2</span></span>
<span><span class="co">## Combination 3          2</span></span>
<span><span class="co">## Combination 4          2</span></span>
<span><span class="co">## Combination 5          2</span></span>
<span><span class="co">## Combination 6          2</span></span>
<span><span class="co">## Combination 7          2</span></span>
<span><span class="co">## Combination 8          2</span></span>
<span><span class="co">## Combination 9          2</span></span>
<span><span class="co">## Combination 10         2</span></span>
<span><span class="co">## Combination 11         3</span></span>
<span><span class="co">## Combination 12         3</span></span>
<span><span class="co">## Combination 13         3</span></span>
<span><span class="co">## Combination 14         3</span></span>
<span><span class="co">## Combination 15         3</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="selection-of-combinations">Selection of combinations<a class="anchor" aria-label="anchor" href="#selection-of-combinations"></a>
</h3>
<p>The markers combinations can now be ranked and selected. After
specifying the case class (“A” in this case), the function
<code><a href="../reference/ranked_combs.html">ranked_combs()</a></code> ranks the combinations by the Youden index
in order to show the combinations with the highest SE (of cases) and SP
(of controls) on the top, facilitating the user in the selection of the
best ones. Again, the Youden index (J) is calculated in this way: <span class="math display">\[
J = SE+SP-1
\]</span> The user can also set (not mandatory) a minimal value of SE
and/or SP that a combination must have to be selected, i.e. to be
considered as <em>“gold” combinations</em>.</p>
<p>A possibility to overview how single markers and all combinations are
distributed in the SE - SP ballpark is to plot them with the bubble
chart code suggested in the Additional Tips&amp;Tricks section (see: <a href="#bubble">Bubble plot of all combinations</a>) starting from the
<code>tab</code> dataframe obtained with the <code><a href="../reference/combi.html">combi()</a></code>
function (see above).</p>
<p>The bigger the bubble, the more markers are in the combination:
looking at the size and distribution of bubbles across SE and SP values
is useful to anticipate how effective will be the combinations in the
ranking. Setting no cutoffs (i.e. SE = 0 and SP = 0), all single markers
and combinations (all bubbles) will be considered as <em>“gold”
combinations</em> and ranked in the next passage.</p>
<p>In the the example below the minimal values of SE and SP are set,
respectively, to 40 and 80, in order to reproduce the gold combinations
selection reported in <a href="https://www.nature.com/articles/srep45477" class="external-link">Mazzara et. al
2017</a>. The obtained values of combinations, ranked according to
Youden index, are stored in the “ranked markers” <code>rmks</code>
object containing the <code>table</code> dataframe and the
<code>bubble_chart</code> plot that can be accessed individually with
the <code>$</code> operator.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ranked_combs.html">ranked_combs</a></span><span class="op">(</span><span class="va">tab</span>, min_SE <span class="op">=</span> <span class="fl">40</span>, min_SP <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span>
<span><span class="va">rmks</span><span class="op">$</span><span class="va">table</span></span></code></pre></div>
<pre><code><span><span class="co">##                                Markers #Positives A #Positives B   SE       SP</span></span>
<span><span class="co">## Combination 11 Marker1-Marker2-Marker3           31            6 77.5 95.38462</span></span>
<span><span class="co">## Combination 1          Marker1-Marker2           29            6 72.5 95.38462</span></span>
<span><span class="co">## Combination 2          Marker1-Marker3           29            6 72.5 95.38462</span></span>
<span><span class="co">## Combination 13 Marker1-Marker2-Marker5           33           21 82.5 83.84615</span></span>
<span><span class="co">## Combination 15 Marker1-Marker3-Marker5           33           21 82.5 83.84615</span></span>
<span><span class="co">## Combination 18 Marker2-Marker3-Marker5           30           17 75.0 86.92308</span></span>
<span><span class="co">## Marker1                        Marker1           26            6 65.0 95.38462</span></span>
<span><span class="co">## Combination 4          Marker1-Marker5           30           21 75.0 83.84615</span></span>
<span><span class="co">## Combination 7          Marker2-Marker5           28           17 70.0 86.92308</span></span>
<span><span class="co">## Combination 9          Marker3-Marker5           27           16 67.5 87.69231</span></span>
<span><span class="co">## Combination 5          Marker2-Marker3           21            2 52.5 98.46154</span></span>
<span><span class="co">## Marker2                        Marker2           19            2 47.5 98.46154</span></span>
<span><span class="co">## Marker5                        Marker5           23           15 57.5 88.46154</span></span>
<span><span class="co">##                n_markers    Youden</span></span>
<span><span class="co">## Combination 11         3 0.7288462</span></span>
<span><span class="co">## Combination 1          2 0.6788462</span></span>
<span><span class="co">## Combination 2          2 0.6788462</span></span>
<span><span class="co">## Combination 13         3 0.6634615</span></span>
<span><span class="co">## Combination 15         3 0.6634615</span></span>
<span><span class="co">## Combination 18         3 0.6192308</span></span>
<span><span class="co">## Marker1                1 0.6038462</span></span>
<span><span class="co">## Combination 4          2 0.5884615</span></span>
<span><span class="co">## Combination 7          2 0.5692308</span></span>
<span><span class="co">## Combination 9          2 0.5519231</span></span>
<span><span class="co">## Combination 5          2 0.5096154</span></span>
<span><span class="co">## Marker2                1 0.4596154</span></span>
<span><span class="co">## Marker5                1 0.4596154</span></span></code></pre>
<p>as mentioned, the <code>rmks</code> object also has a slot for the
<code>bubble_chart</code> plot, that can be recalled with the usual
<code>$</code> operator. This plot discriminates between combinations
not passing the SE and SP cutoffs as set in <code><a href="../reference/ranked_combs.html">ranked_combs()</a></code>
(blue bubbles) and <em>“gold” combinations</em> passing them (yellow
bubbles).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmks</span><span class="op">$</span><span class="va">bubble_chart</span></span></code></pre></div>
<p><img src="combiroc_vignette_1_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="roc-curves">ROC curves<a class="anchor" aria-label="anchor" href="#roc-curves"></a>
</h3>
<p>To allow an objective comparison of combinations, the function
<code><a href="../reference/roc_reports.html">roc_reports()</a></code> applies the Generalised Linear Model
(<code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">stats::glm()</a></code> with argument <code>family= binomial</code>)
for each gold combination. The resulting predictions are then used to
compute ROC curves (with function <code><a href="https://rdrr.io/pkg/pROC/man/roc.html" class="external-link">pROC::roc()</a></code>) and their
corresponding metrics which are both returned by the function as a named
list object (in this case called <strong>reports</strong>). The function
<code><a href="../reference/roc_reports.html">roc_reports()</a></code> requires as input:</p>
<ul>
<li>The data object ( <strong>data</strong> ) obtained with
<code><a href="../reference/load_data.html">load_data()</a></code>;</li>
<li>the table with combinations and corresponding positive samples
counts ( <strong>tab</strong> ), obtained with
<code><a href="../reference/combi.html">combi()</a></code>.</li>
</ul>
<p>In addition, the user has to specify the class case, and the single
markers and/or the combinations that she/he wants to be displayed with
the specific function’s arguments.<br>
In the example below a single marker ( <strong>Marker1</strong> ) and
two combinations (combinations number <strong>11</strong> and
<strong>15</strong> ) were choosen.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reports</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/roc_reports.html">roc_reports</a></span><span class="op">(</span><span class="va">data</span>, markers_table <span class="op">=</span> <span class="va">tab</span>, </span>
<span>                      case_class <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>                      single_markers <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Marker1'</span><span class="op">)</span>, </span>
<span>                      selected_combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The obtained <strong>reports</strong> object contains 3 items that
can be accessed using the <code>$</code> operator:</p>
<ul>
<li>Plot: a ggplot object with the ROC curves of the selected
combinations;</li>
<li>Metrics: a dataframe with the metrics of the roc curves (AUC, opt.
cutoff, etc …);</li>
<li>Models: The list of models that have been computed and then used to
classify the samples (the equation for each selected combination).</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reports</span><span class="op">$</span><span class="va">Plot</span></span></code></pre></div>
<p><img src="combiroc_vignette_1_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reports</span><span class="op">$</span><span class="va">Metrics</span></span></code></pre></div>
<pre><code><span><span class="co">##                  AUC   SE    SP CutOff   ACC  TN TP FN FP   NPV   PPV</span></span>
<span><span class="co">## Marker1        0.910 0.90 0.808  0.219 0.829 105 36  4 25 0.963 0.590</span></span>
<span><span class="co">## Combination 11 0.942 0.95 0.869  0.216 0.888 113 38  2 17 0.983 0.691</span></span>
<span><span class="co">## Combination 15 0.935 0.90 0.854  0.248 0.865 111 36  4 19 0.965 0.655</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reports</span><span class="op">$</span><span class="va">Models</span></span></code></pre></div>
<pre><code><span><span class="co">## $Marker1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glm(formula = fla, family = "binomial", data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##      (Intercept)  log(Marker1 + 1)  </span></span>
<span><span class="co">##          -13.775             2.246  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees of Freedom: 169 Total (i.e. Null);  168 Residual</span></span>
<span><span class="co">## Null Deviance:       185.5 </span></span>
<span><span class="co">## Residual Deviance: 101.7     AIC: 105.7</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Combination 11`</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glm(formula = fla, family = "binomial", data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##      (Intercept)  log(Marker1 + 1)  log(Marker2 + 1)  log(Marker3 + 1)  </span></span>
<span><span class="co">##         -17.0128            1.5378            0.9176            0.5706  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees of Freedom: 169 Total (i.e. Null);  166 Residual</span></span>
<span><span class="co">## Null Deviance:       185.5 </span></span>
<span><span class="co">## Residual Deviance: 87.49     AIC: 95.49</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Combination 15`</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glm(formula = fla, family = "binomial", data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##      (Intercept)  log(Marker1 + 1)  log(Marker3 + 1)  log(Marker5 + 1)  </span></span>
<span><span class="co">##         -16.0554            1.9595            0.6032            0.2805  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees of Freedom: 169 Total (i.e. Null);  166 Residual</span></span>
<span><span class="co">## Null Deviance:       185.5 </span></span>
<span><span class="co">## Residual Deviance: 87.95     AIC: 95.95</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="hood">Under the hood<a class="anchor" aria-label="anchor" href="#hood"></a>
</h3>
<p>For a bit deeper discussion on how to interpret the results, this
section will be focused on a single specific combination in the dataset
seen so far: “Combination 11”, combining Marker1, Marker2 and Marker3.
This combination has an <strong>optimal cutoff</strong> equal to 0.216
(see the <strong>CutOff</strong> column in
<code>reports$Metrics</code>).<br>
The following is the regression equation being used by the Generalized
Linear Model (glm) function to compute the predictions:</p>
<p><span class="math display">\[
f(x)=β_0+β_1x_1+β_2x_2+ β_3x_3 +...+β_nx_n
\]</span></p>
<p>Where <span class="math inline">\(β_n\)</span> are the coefficients
(being <span class="math inline">\(β_0\)</span> the intercept)
determined by the model and <span class="math inline">\(x_n\)</span> the
variables.<br>
While, the predicted probabilities have been calculated with the sigmoid
function:</p>
<p><span class="math display">\[
p(x) =  \frac{\mathrm{1} }{\mathrm{1} + e^{-f(x)} }  
\]</span></p>
<p>In accordance with the above, the predictions for “Combination 11”
have been computed using the coefficients displayed as in
<code>reports$Models</code> (see previous paragraph), and this
combination’s prediction equation will be:</p>
<p><span class="math display">\[
f(x)=    -17.0128  +  1.5378 *log(Marker1 + 1)  +  0.9176 *log(Marker2 +
1) + 0.5706* log(Marker3 + 1)
\]</span></p>
<p>As for the predict method for a Generalized Linear Model, predictions
are produced on the scale of the additive predictors. Predictions (<span class="math inline">\(f(x)\)</span> values) of Combination 11 can be
visualized using the commmand <code>glm::predict</code> with argument
<code>type = "link"</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reports</span><span class="op">$</span><span class="va">Models</span><span class="op">$</span><span class="va">`Combination 11`</span>, type<span class="op">=</span><span class="st">'link'</span><span class="op">)</span><span class="op">)</span> <span class="co"># link = f(x)</span></span></code></pre></div>
<pre><code><span><span class="co">##            1            2            3            4            5            6 </span></span>
<span><span class="co">##  0.166224681 -0.008125528  2.192603482  1.077910194  3.816098810  0.593971602</span></span></code></pre>
<p>Prediction probabilities (<span class="math inline">\(p(x)\)</span>
values, i.e. predictions on the scale of the response) of Combination 11
can be instead visualized using argument
<code>type = "response"</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reports</span><span class="op">$</span><span class="va">Models</span><span class="op">$</span><span class="va">`Combination 11`</span>, type<span class="op">=</span><span class="st">'response'</span><span class="op">)</span><span class="op">)</span> <span class="co"># response = p(x)</span></span></code></pre></div>
<pre><code><span><span class="co">##         1         2         3         4         5         6 </span></span>
<span><span class="co">## 0.5414607 0.4979686 0.8995833 0.7460983 0.9784606 0.6442759</span></span></code></pre>
<p>Finally, the comparison between the prediction probability and the
optimal cutoff (here 0.216, see the <strong>CutOff</strong> column for
Classification 11 in <code>reports$Metrics</code>) determines the
classification of each sample by following this rule:</p>
<p><span class="math display">\[
C(x) =
\begin{cases}
      1 &amp; {p}(x) &gt; opt. cutoff \\
      0 &amp; {p}(x) \leq opt.cutoff
\end{cases}
\]</span></p>
<p>Specifically, for “Combination 11”:</p>
<ul>
<li>Samples with <span class="math inline">\(p(x)\)</span> higher than
0.216 are classified as “positives” (1).</li>
<li>Samples with <span class="math inline">\(p(x)\)</span> lower or
equal to 0.216 are classified as “negatives” (0).</li>
</ul>
<p>Thus, using 0.216 as cutoff, Combination 11 is able to classify the
samples in the dataset with a SE equal to 95.0%, SP equal to 86.9%, and
accuracy equal to 88.8% (see <strong>ROC curves</strong>,
<code>reports$Metrics</code>).</p>
</div>
</div>
<div class="section level2">
<h2 id="classification-of-new-samples">Classification of new samples<a class="anchor" aria-label="anchor" href="#classification-of-new-samples"></a>
</h2>
<p>A new feature of the CombiROC package (not present in the CombiROC
tool Shiny app), offers the possibility to exploit the models obtained
with <code><a href="../reference/roc_reports.html">roc_reports()</a></code> for each selected marker/combination
(and assigned to <code>reports$Models</code>) to directly classify new
samples that are not labelled, <em>i.e.</em> <strong>not
assigned</strong> to any case or control classes.</p>
<p>The unclassified data set must be similar to the data set used for
the previous combinatorial analysis ( <em>i.e.</em> of the same nature
and with the same markers, but obviously <em>without</em> the ‘Class’
column).</p>
<p>To load datasets with unclassified samples <code>labelled_data</code>
in <code><a href="../reference/load_data.html">load_data()</a></code> function must be set to <em>FALSE</em>. In
this way the function loads the same kind of files and it performs the
same format checks shown above, with the exception of the <em>Class</em>
column which is not present in an unclassified datasets and thus not
checked.</p>
<p>For purely demonstrative purposes, in the following example a
“synthetic” unclassified data set
(‘data/unclassified_proteomic_data.csv’) was used: it was obtained by
randomly picking 20 samples from the already classified data set (the
<strong>data</strong>). The loaded unclassified sample is here assigned
to the <strong>unc_data</strong> object.<br>
Please note that this unclassified data set lacks the “Class” column but
has a Patient.ID column which actually allows the identification of the
class <strong>but sample names here are not used in the workflow and
have labeling purposes to check the prediction outcomes</strong> (a “no”
prefix identifies healthy/normal subjects while the absence of the
prefix identifies affected/abnormal subjects).</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_data.html">load_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="st">'./data/demo_unclassified_data.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, labelled_data <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p>This very same dataset has been included in CombiROC package as an
unclassified demo dataset, which can be directly called typing
<code>demo_unclassified_data</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">demo_unclassified_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Patient.ID Marker1 Marker2 Marker3 Marker4 Marker5</span></span>
<span><span class="co">## 1      AIH33    1964     875     404    1883    1021</span></span>
<span><span class="co">## 2  no AIH126     381     303       4     266     376</span></span>
<span><span class="co">## 3      AIH12     261     153     528     449     237</span></span>
<span><span class="co">## 4  no AIH112     144     155      25     600       0</span></span>
<span><span class="co">## 5   no AIH41       0     193      50     382     135</span></span>
<span><span class="co">## 6   no AIH38      46      51      24     342      74</span></span></code></pre>
<p>The prediction of the class can be achieved with
<code><a href="../reference/combi_score.html">combi_score()</a></code>: by setting <code>classify</code>=TRUE, this
function applies the models previously calculated on a classified data
set working as training dataset, to the unclassified dataset and
classifies the samples accordingly to the prediction probability and
optimal cutoff as shown in the <a href="#hood">Under the hood</a>
section.</p>
<p>This <code><a href="../reference/combi_score.html">combi_score()</a></code> function takes as inputs:</p>
<ul>
<li>the unclassified data set containing the new samples to be
classified (<code>unc_data</code>);</li>
<li>the list of models <code>reports$Models</code> that have been
previously computed by <code><a href="../reference/roc_reports.html">roc_reports()</a></code>
(<em>reports$Models</em>);</li>
<li>the list of metrics that have been previously computed by
<code><a href="../reference/roc_reports.html">roc_reports()</a></code> (<em>reports$Metrics</em>).</li>
</ul>
<p>The user can set the labels of the predicted class (setting
<code>Positive_class</code> and <code>Negative_class</code>), otherwise
they will be <strong>1</strong> for positive samples and
<strong>0</strong> for the negative samples by default (see the rule
shown in the end of the <strong>Results explanation</strong> section).
Here we are setting <code>Positive_class = "affected"</code> and
<code>Negative_class = "healthy"</code></p>
<p>The function returns a data.frame (<code>cl_data</code> in the
example below), whose columns contain the predicted class for each
sample according to the models used (originally in
<code>reports$Models</code>); here we are still using
<strong>Marker1</strong>, <strong>Combination 11</strong> and
<strong>Combination 15</strong>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unc_data</span> <span class="op">&lt;-</span> <span class="va">demo_unclassified_data</span></span>
<span><span class="va">cl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combi_score.html">combi_score</a></span><span class="op">(</span><span class="va">unc_data</span>, </span>
<span>                       Models <span class="op">=</span>  <span class="va">reports</span><span class="op">$</span><span class="va">Models</span>, </span>
<span>                       Metrics <span class="op">=</span> <span class="va">reports</span><span class="op">$</span><span class="va">Metrics</span>, </span>
<span>                       Positive_class <span class="op">=</span> <span class="st">"abnormal"</span>, </span>
<span>                       Negative_class <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>                       classify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As can be observed comparing the outcome in the dataframe with the
tag on samples’ names, the single marker <strong>Marker1</strong> is not
100% efficient in correctly predicting the class (see mismatch in second
row, where the <em>normal</em> sample “no AIH126” is classified as
<em>abnormal</em> by Marker1); instead, both Combination 11 and 15
correctly assign it to the right class.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl_data</span></span></code></pre></div>
<pre><code><span><span class="co">##           ID  Marker1 Combination 11 Combination 15</span></span>
<span><span class="co">## 1      AIH33 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 2  no AIH126 abnormal         normal         normal</span></span>
<span><span class="co">## 3      AIH12 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 4  no AIH112   normal         normal         normal</span></span>
<span><span class="co">## 5   no AIH41   normal         normal         normal</span></span>
<span><span class="co">## 6   no AIH38   normal         normal         normal</span></span>
<span><span class="co">## 7       AIH4 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 8   no AIH32   normal         normal         normal</span></span>
<span><span class="co">## 9      AIH20 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 10  no AIH13   normal         normal         normal</span></span>
<span><span class="co">## 11  no AIH11   normal         normal         normal</span></span>
<span><span class="co">## 12 no AIH114   normal         normal         normal</span></span>
<span><span class="co">## 13 no AIH121   normal         normal         normal</span></span>
<span><span class="co">## 14     AIH17 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 15     AIH14 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 16 no AIH106   normal         normal         normal</span></span>
<span><span class="co">## 17  no AIH67   normal         normal         normal</span></span>
<span><span class="co">## 18      AIH9 abnormal       abnormal       abnormal</span></span>
<span><span class="co">## 19  no AIH74   normal         normal         normal</span></span>
<span><span class="co">## 20     AIH16 abnormal       abnormal       abnormal</span></span></code></pre>
<p>Thus, each column of the prediction dataframe contains the prediction
outcome of a given model and, along with the samples names (in the
<em>index</em> column), can be accessed with the $ operator as
usual:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl_data</span><span class="op">$</span><span class="va">index</span></span></code></pre></div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cl_data</span><span class="op">$</span><span class="va">`Combination 11`</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "abnormal" "normal"   "abnormal" "normal"   "normal"   "normal"  </span></span>
<span><span class="co">##  [7] "abnormal" "normal"   "abnormal" "normal"   "normal"   "normal"  </span></span>
<span><span class="co">## [13] "normal"   "abnormal" "abnormal" "normal"   "normal"   "abnormal"</span></span>
<span><span class="co">## [19] "normal"   "abnormal"</span></span></code></pre>
<p>In addition, by setting <code>classify</code>=FALSE,
<code><a href="../reference/combi_score.html">combi_score()</a></code> can be exploited to easily retrieve the
predicted probabilities of each combination (p(x) a.k.a ‘combi score’)
in unclassified datasets.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">unc_data</span> <span class="op">&lt;-</span> <span class="va">demo_unclassified_data</span></span>
<span><span class="va">cs_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combi_score.html">combi_score</a></span><span class="op">(</span><span class="va">unc_data</span>, </span>
<span>                       Models <span class="op">=</span>  <span class="va">reports</span><span class="op">$</span><span class="va">Models</span>, </span>
<span>                       Metrics <span class="op">=</span> <span class="va">reports</span><span class="op">$</span><span class="va">Metrics</span>, </span>
<span>                       Positive_class <span class="op">=</span> <span class="st">"abnormal"</span>, </span>
<span>                       Negative_class <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>                       classify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">cs_data</span></span></code></pre></div>
<pre><code><span><span class="co">##           ID      Marker1 Combination 11 Combination 15</span></span>
<span><span class="co">## 1      AIH33 9.629030e-01   9.864991e-01   9.875017e-01</span></span>
<span><span class="co">## 2  no AIH126 3.960193e-01   1.537155e-01   1.455281e-01</span></span>
<span><span class="co">## 3      AIH12 2.194324e-01   4.378589e-01   5.432861e-01</span></span>
<span><span class="co">## 4  no AIH112 6.928584e-02   5.381403e-02   1.289242e-02</span></span>
<span><span class="co">## 5   no AIH41 1.041071e-06   4.840652e-05   4.525821e-06</span></span>
<span><span class="co">## 6   no AIH38 5.893585e-03   3.576392e-03   4.687486e-03</span></span>
<span><span class="co">## 7       AIH4 6.007967e-01   7.460983e-01   6.533166e-01</span></span>
<span><span class="co">## 8   no AIH32 2.799238e-02   9.912527e-03   1.635574e-02</span></span>
<span><span class="co">## 9      AIH20 4.661915e-01   5.588462e-01   6.067799e-01</span></span>
<span><span class="co">## 10  no AIH13 1.041071e-06   4.087306e-08   2.534146e-07</span></span>
<span><span class="co">## 11  no AIH11 1.041071e-06   3.153259e-06   3.309952e-07</span></span>
<span><span class="co">## 12 no AIH114 1.664621e-01   8.160105e-02   9.545823e-02</span></span>
<span><span class="co">## 13 no AIH121 2.799238e-02   9.247089e-02   3.612256e-02</span></span>
<span><span class="co">## 14     AIH17 9.985976e-01   9.999299e-01   9.999348e-01</span></span>
<span><span class="co">## 15     AIH14 5.455001e-01   6.805223e-01   7.390291e-01</span></span>
<span><span class="co">## 16 no AIH106 4.001370e-02   1.099469e-02   1.870649e-02</span></span>
<span><span class="co">## 17  no AIH67 1.616676e-02   6.082032e-04   1.604146e-03</span></span>
<span><span class="co">## 18      AIH9 5.869070e-01   8.034081e-01   8.027712e-01</span></span>
<span><span class="co">## 19  no AIH74 1.041071e-06   1.425832e-06   1.064701e-07</span></span>
<span><span class="co">## 20     AIH16 9.973708e-01   9.999000e-01   9.998317e-01</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="ancill">Ancillary functions<a class="anchor" aria-label="anchor" href="#ancill"></a>
</h2>
<div class="section level3">
<h3 id="retrieving-composition-of-combinations">Retrieving composition of combinations<a class="anchor" aria-label="anchor" href="#retrieving-composition-of-combinations"></a>
</h3>
<p><code><a href="../reference/show_markers.html">show_markers()</a></code> returns a data frame containing the
composition of each combination of interest. It requires as input one or
more combinations (only their numbers), and the table with combinations
and corresponding positive samples counts (<em>“tab”</em>, obtained with
<code><a href="../reference/combi.html">combi()</a></code>).</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/show_markers.html">show_markers</a></span><span class="op">(</span>selected_combinations <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">15</span><span class="op">)</span>, markers_table <span class="op">=</span> <span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      Combination       Composing_markers</span></span>
<span><span class="co">## 1 Combination 11 Marker1-Marker2-Marker3</span></span>
<span><span class="co">## 2 Combination 15 Marker1-Marker3-Marker5</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="retrieving-combinations-containing-markers-of-interest">Retrieving combinations containing markers of interest<a class="anchor" aria-label="anchor" href="#retrieving-combinations-containing-markers-of-interest"></a>
</h3>
<p><code><a href="../reference/combs_with.html">combs_with()</a></code> returns the combinations containing all the
markers of interest. It requires as input one or more single marker, and
the table with combinations and corresponding positive samples counts
(<em>“tab”</em>, obtained with <code><a href="../reference/combi.html">combi()</a></code>). The list with the
combinations containing all the markers is assigned to
<em>“combs_list”</em> object.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combs_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combs_with.html">combs_with</a></span><span class="op">(</span>markers<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Marker1'</span>, <span class="st">'Marker3'</span><span class="op">)</span>, markers_table <span class="op">=</span> <span class="va">tab</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The combinations in which you can find ALL the selected markers have been computed</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combs_list</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  2 11 14 15</span></span></code></pre>
<p>Back to the <a href="#top">top</a> of this doc</p>
<p>Go to <a href="https://ingmbioinfo.github.io/combiroc/articles/combiroc_vignette_2.html">Signature
refining tutorial</a></p>
<p>Session Info for this vignette:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] combiroc_0.3.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.6        utf8_1.2.3        generics_0.1.3    tidyr_1.3.0      </span></span>
<span><span class="co">##  [5] gtools_3.9.4      stringi_1.7.12    digest_0.6.32     magrittr_2.0.3   </span></span>
<span><span class="co">##  [9] pROC_1.18.2       evaluate_0.21     grid_4.3.1        fastmap_1.1.1    </span></span>
<span><span class="co">## [13] rprojroot_2.0.3   plyr_1.8.8        jsonlite_1.8.7    purrr_1.0.1      </span></span>
<span><span class="co">## [17] fansi_1.0.4       scales_1.2.1      textshaping_0.3.6 jquerylib_0.1.4  </span></span>
<span><span class="co">## [21] cli_3.6.1         rlang_1.1.1       munsell_0.5.0     withr_2.5.0      </span></span>
<span><span class="co">## [25] cachem_1.0.8      yaml_2.3.7        tools_4.3.1       memoise_2.0.1    </span></span>
<span><span class="co">## [29] dplyr_1.1.2       colorspace_2.1-0  ggplot2_3.4.2     vctrs_0.6.3      </span></span>
<span><span class="co">## [33] R6_2.5.1          lifecycle_1.0.3   stringr_1.5.0     fs_1.6.2         </span></span>
<span><span class="co">## [37] ragg_1.2.5        pkgconfig_2.0.3   desc_1.4.2        pkgdown_2.0.7    </span></span>
<span><span class="co">## [41] pillar_1.9.0      bslib_0.5.0       gtable_0.3.3      glue_1.6.2       </span></span>
<span><span class="co">## [45] moments_0.14.1    Rcpp_1.0.10       systemfonts_1.0.4 highr_0.10       </span></span>
<span><span class="co">## [49] xfun_0.39         tibble_3.2.1      tidyselect_1.2.0  knitr_1.43       </span></span>
<span><span class="co">## [53] farver_2.1.1      htmltools_0.5.5   labeling_0.4.2    rmarkdown_2.22   </span></span>
<span><span class="co">## [57] compiler_4.3.1</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ivan Ferrari, Riccardo L. Rossi, Saveria Mazzara.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
