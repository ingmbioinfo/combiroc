<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A function that takes as input data in long format, and shows how the signal intensity value of markers are distributed."><title>Show distribution of intensity values for all the markers both singularly and all together. — markers_distribution • combiroc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Show distribution of intensity values for all the markers both singularly and all together. — markers_distribution"><meta property="og:description" content="A function that takes as input data in long format, and shows how the signal intensity value of markers are distributed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">combiroc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/combiroc_vignette_1.html">Standard Workflow</a>
    <a class="dropdown-item" href="../articles/combiroc_vignette_2.html">SingleCell Workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ingmbioinfo/combiroc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Show distribution of intensity values for all the markers both singularly and all together.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ingmbioinfo/combiroc/blob/HEAD/R/markers_distribution.R" class="external-link"><code>R/markers_distribution.R</code></a></small>
      <div class="d-none name"><code>markers_distribution.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function that takes as input data in long format, and shows how the signal intensity value of markers are distributed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">markers_distribution</span><span class="op">(</span></span>
<span>  <span class="va">data_long</span>,</span>
<span>  min_SE <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  min_SP <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  x_lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boxplot_lim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  signalthr_prediction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">case_class</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data_long</dt>
<dd><p>a data.frame in long format returned by combiroc_long()</p></dd>


<dt>min_SE</dt>
<dd><p>a numeric that specifies the min value of SE that a threshold must have to be included in $Coord.</p></dd>


<dt>min_SP</dt>
<dd><p>a numeric that specifies the min value of SP that a threshold must have to be included in $Coord.</p></dd>


<dt>x_lim</dt>
<dd><p>a numeric setting the max values of x that will be visualized in the density plot (zoom only, no data loss).</p></dd>


<dt>y_lim</dt>
<dd><p>a numeric setting the max values of y that will be visualized in the density plot (zoom only, no data loss).</p></dd>


<dt>boxplot_lim</dt>
<dd><p>a numeric setting the max values of y that will be visualized in the boxplot (zoom only, no data loss).</p></dd>


<dt>signalthr_prediction</dt>
<dd><p>a boolean that specifies if the density plot will also show the "suggested signal threshold".</p></dd>


<dt>case_class</dt>
<dd><p>a character that specifies which of the two classes of the dataset is the case class.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a named list containing 'Coord' and 'Density_summary' data.frames, and 'ROC', 'Boxplot' and 'Density_plot' plot objects.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function returns a named list containing the following objects:</p><ul><li><p>“Density_plot”: a density plot showing the distribution of the signal intensity values for both the classes.</p></li>
<li><p>"Density_summary": a data.frame showing a summary statistics of the distributions.</p></li>
<li><p>“ROC”: a ROC curve showing how many real positive samples would be found positive (SE) and how many real negative samples would be found negative (SP) in function of signal threshold. NB: these SE and SP are refereed to the signal intensity threshold considering all the markers together; it is NOT equal to the SE/SP of a single marker/combination found with se_sp().</p></li>
<li><p>“Coord”: a data.frame that contains the coordinates of the above described “ROC” (threshold, SP and SE) that have at least a min SE (40 by default) and a min SP (80 by default).</p></li>
<li><p>"Boxplot": a boxplot showing the distribution of the signal intensity values of each marker singularly, for both the classes.</p></li>
</ul><p>In case of lack of a priori known threshold the user can set set signalthr_prediction= TRUE.
In this way the function provides a "suggested signal threshold" that corresponds to the median of the singnal threshold values (in "Coord") at which SE/SP are grater or equal to their set minimal values (min_SE and min_SP),
and it adds this threshold on the "Density_plot" object as a dashed black line.
The use of the median allows to pick a threshold whose SE/SP are not too close to the limits (min_SE and min_SP), but it is recommended to always inspect "Coord" and choose the most appropriate signal threshold by considering SP, SE and Youden index.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">demo_data</span> <span class="co"># combiroc built-in demo data (proteomics data from Zingaretti et al. 2012 - PMC3518104)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Patient.ID Class Marker1 Marker2 Marker3 Marker4 Marker5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         AIH1     A     438     187     197     298     139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         AIH2     A     345     293     134     523     335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         AIH3     A     903     392     300    1253       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         AIH4     A     552     267     296     666      22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         AIH5     A    1451     760     498     884     684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         AIH6     A     497     260     175     640     572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7         AIH7     A    3878    2858     510    1518     348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8         AIH8     A     740     368     266    1391     647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9         AIH9     A     538     412     282    1071     474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10       AIH10     A    1194    1065     442    1530     816</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       AIH11     A     988     817     394    1626    1028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12       AIH12     A     261     153     528     449     237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13       AIH13     A     312     181      58     408     661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14       AIH14     A     499     302     181    1088     568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15       AIH15     A     998     431      75     397     519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16       AIH16     A    6485    3704    8834    2595    1570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17       AIH17     A    8584    2662   13178    3390    2757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18       AIH18     A    1696    1029     369     468    2422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19       AIH19     A     774     505     251    1014     517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20       AIH20     A     433     330      92    1266     743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21       AIH21     A    1207    1501      57    1847     741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22       AIH22     A     225     849     125     330     168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23       AIH23     A    1327     485     366     563     878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24       AIH24     A      76     582     601     115      73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25       AIH25     A     586     256      53     710      74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26       AIH26     A     263     196     124     798      95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27       AIH27     A     146     568      64     125      92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28       AIH28     A     537     620      82     350      53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29       AIH29     A      52      41     588     346      50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30       AIH30     A     882     138      47     601      85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31       AIH31     A     462     304      81     378     208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32       AIH32     A     372     149       0     460     156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33       AIH33     A    1964     875     404    1883    1021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34       AIH34     A    2809    1633     451    1042     608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35       AIH35     A     994     505     303    1699     783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36       AIH36     A     361     185     115     466     520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37       AIH37     A     275     384      45     329     466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38       AIH38     A     947     622      16     236     728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39       AIH39     A     405     133      32     284     358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40       AIH40     A     922     689      68     105     643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41     no AIH1     B     510      28       0     332       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42     no AIH2     B     205       0       0     332       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43     no AIH3     B      44       0       0     332      21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44     no AIH4     B      49      38       7     178      48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45     no AIH5     B      26      33       6     131      32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46     no AIH6     B      24      26       8     206      28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47     no AIH7     B     243     373     109     631     477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48     no AIH8     B      99     111      51     193     197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49     no AIH9     B      85      55      71     811     321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50    no AIH10     B     146     108      46     173     171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51    no AIH11     B       0     113       0       0      56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52    no AIH12     B     151       0       0     360       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53    no AIH13     B       0       0       0      15      21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54    no AIH14     B       0       5       0     147      53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55    no AIH15     B     118      69      13     748      97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56    no AIH16     B      31      29       7     223      34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57    no AIH17     B      72      53      12     376      85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58    no AIH18     B     137     151      20     662     131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59    no AIH19     B      78      58       6     368      49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60    no AIH20     B     193      14      90     703     177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61    no AIH21     B       0       0       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62    no AIH22     B       0      20       0      66      31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63    no AIH23     B     351      70       0     478       7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64    no AIH24     B     171     127      74    1202     224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65    no AIH25     B      77      75      26     316      61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66    no AIH26     B      51      45       2     286      44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67    no AIH27     B      64      55      17     333      46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68    no AIH28     B     150     185      42     975     252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69    no AIH29     B     149     140      52    1087     209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70    no AIH30     B     147     103      19     794      98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71    no AIH31     B      86      89      44     427     144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72    no AIH32     B      94      57      18     581      88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73    no AIH33     B      56      41      23     244      49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74    no AIH34     B      10      15       2     121      26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75    no AIH35     B      46      22       0      69      24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76    no AIH36     B      84      65       4     278      77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77    no AIH37     B      42      44      19     306      86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78    no AIH38     B      46      51      24     342      74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79    no AIH39     B      73      39       9     358      41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80    no AIH40     B      83     131      27    1012     124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81    no AIH41     B       0     193      50     382     135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82    no AIH42     B      41      94      64     464     141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83    no AIH43     B       0      77      46     398      85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84    no AIH44     B      98     152      91     469     301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85    no AIH45     B      78      85      10     407       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86    no AIH46     B      21      16       0     536      16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87    no AIH47     B      44      34      74     266      21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88    no AIH48     B     144      76      63     252       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89    no AIH49     B     162     249     101     134       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90    no AIH50     B     100     169      33    1430       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91    no AIH51     B      52     159      57     681     417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92    no AIH52     B      97      86      64     591      33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93    no AIH53     B      73      80      20     157      51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94    no AIH54     B     162     117      25     749       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95    no AIH55     B     100     220      37     729      41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96    no AIH56     B     227     174      26     290       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97    no AIH57     B     136     165      23     315      40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98    no AIH58     B      96     213      47     682     780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99    no AIH59     B      69      59      21     629     245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100   no AIH60     B      74      70      67     138     215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101   no AIH61     B     129     118      44     117     769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102   no AIH62     B     265     173     115    1157    1310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103   no AIH63     B     308     265     290    2464     840</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104   no AIH64     B     276     179     203    1848     563</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105   no AIH65     B     173     119     194    2245     726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106   no AIH66     B     354     156       0     227     109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 107   no AIH67     B      73      25       0     267      68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108   no AIH68     B     111      80      42     384     180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109   no AIH69     B     148      90      54     479     235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110   no AIH70     B     229     367      12       3     595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111   no AIH71     B     388     316       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112   no AIH72     B       0       5       0     300     323</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113   no AIH73     B       0      66      22      92       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114   no AIH74     B       0      47       0     337       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115   no AIH75     B       0     256      42     760       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116   no AIH76     B     107      61      26     391       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117   no AIH77     B     174     109      57     428     223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118   no AIH78     B      42      46      13     235     319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119   no AIH79     B     180     146      34     362     249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120   no AIH80     B      79      66      57     378     307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121   no AIH81     B     419      86      51     376     533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122   no AIH82     B     448     133      95     631     122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123   no AIH83     B       0     119      49     399     154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124   no AIH84     B     148      90      67     285     167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125   no AIH85     B      11     155      19     231       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126   no AIH86     B     165     162     167     912     405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127   no AIH87     B     320     150      88     107    4114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128   no AIH88     B     146      87     111     395     238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129   no AIH89     B      90     102      62     112     267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130   no AIH90     B     257     188     171     644     347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131   no AIH91     B     106      60      63     336       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132   no AIH92     B    1223     584     640     256       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133   no AIH93     B     519     287     283       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134   no AIH94     B     327     240     101     102       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135   no AIH95     B     559    2142      59     279     413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136   no AIH96     B     202     201      29     248       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137   no AIH97     B     212      88      45     472       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138   no AIH98     B     426     125      68      99     566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 139   no AIH99     B     260     135     105     285      34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140  no AIH100     B     371     257      96     528      75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141  no AIH101     B     254      99     105     332      13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142  no AIH102     B     107      86     121     786     168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143  no AIH103     B     265     209      40     328      10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144  no AIH104     B     201     189      31     559       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145  no AIH105     B      79      63      38     159       2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146  no AIH106     B     111      34      32     343      13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147  no AIH107     B     130     185       0     577     923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148  no AIH108     B      58      29      11     545       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149  no AIH109     B      49      56      34     390       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150  no AIH110     B     158     165      68     227       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151  no AIH111     B     159     205      25     151      32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152  no AIH112     B     144     155      25     600       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153  no AIH113     B     111     155      83     179      65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154  no AIH114     B     224     115      27     276      67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155  no AIH115     B      85      85      13     123      48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156  no AIH116     B     362     296      11     176      72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157  no AIH117     B     273     264     122    1418     476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158  no AIH118     B     425     402      86    1702     581</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159  no AIH119     B     315     418       0     595     305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160  no AIH120     B     463     379      71     626     313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161  no AIH121     B      94     413      46     400     229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162  no AIH122     B     163     115     285     590     213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163  no AIH123     B       0       0       0    1053     362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164  no AIH124     B       0       0       0     430      26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 165  no AIH125     B      83      61     299     476     219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 166  no AIH126     B     381     303       4     266     376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 167  no AIH127     B     253     106     134     626     189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 168  no AIH128     B     571      96      31     487     423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169  no AIH129     B     288     298       0     347     411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 170  no AIH130     B     135     149     229     864     600</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">demo_data_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="combiroc_long.html">combiroc_long</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">demo_data</span><span class="op">)</span> <span class="co"># long format data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To visualize the distribution of the expression of each marker.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">distributions</span> <span class="op">&lt;-</span> <span class="fu">markers_distribution</span><span class="op">(</span>data_long <span class="op">=</span> <span class="va">demo_data_long</span>,</span></span>
<span class="r-in"><span>                                       boxplot_lim <span class="op">=</span> <span class="fl">1500</span>, y_lim <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>                                       x_lim <span class="op">=</span> <span class="fl">3000</span> , signalthr_prediction <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                       case_class <span class="op">=</span> <span class="st">'A'</span>, min_SE <span class="op">=</span> <span class="fl">40</span>, min_SP <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">distributions</span><span class="op">$</span><span class="va">Density_plot</span> <span class="co"># density plot</span></span></span>
<span class="r-plt img"><img src="markers_distribution-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">distributions</span><span class="op">$</span><span class="va">Density_summary</span> <span class="co"># summary statistics of density plot</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Class `# observations`   Min   Max Median  Mean `1st Q` `3rd Q`    SD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> A                  200     0 <span style="text-decoration: underline;">13</span>178    461  814.    233.     825 <span style="text-decoration: underline;">1</span>427.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> B                  650     0  <span style="text-decoration: underline;">4</span>114    106  206.     38      266  318.</span>
<span class="r-in"><span><span class="va">distributions</span><span class="op">$</span><span class="va">ROC</span> <span class="co"># ROC showing signal threshold range ensuring min SE and/or SP</span></span></span>
<span class="r-plt img"><img src="markers_distribution-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">distributions</span><span class="op">$</span><span class="va">Coord</span> <span class="co"># ROC values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     threshold specificity sensitivity    Youden</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 240     319.5          80          65 0.4500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 241     320.5          80          65 0.4515385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 242     322.0          80          65 0.4530769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 243     325.0          80          65 0.4546154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 244     327.5          81          65 0.4561538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 245     328.5          81          65 0.4576923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246     329.5          81          64 0.4526923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247     331.0          81          64 0.4426923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248     332.5          81          64 0.4488462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249     334.0          82          64 0.4503846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250     335.5          82          63 0.4453846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 251     336.5          82          63 0.4469231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 252     339.5          82          63 0.4484615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 253     342.5          82          63 0.4500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 254     344.0          82          63 0.4515385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 255     345.5          82          62 0.4465385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 256     346.5          82          62 0.4415385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 257     347.5          82          62 0.4446154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 258     349.0          82          62 0.4396154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 259     350.5          82          61 0.4346154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 260     352.5          83          61 0.4361538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 261     356.0          83          61 0.4376923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 262     359.0          83          60 0.4342308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 263     360.5          83          60 0.4357692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 264     361.5          83          60 0.4307692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 265     364.0          84          60 0.4353846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 266     366.5          84          60 0.4303846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 267     367.5          84          60 0.4319231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 268     368.5          84          59 0.4284615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 269     370.0          84          58 0.4234615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 270     371.5          84          58 0.4250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 271     372.5          84          58 0.4200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 272     374.5          84          58 0.4215385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 273     377.0          85          58 0.4261538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 274     378.5          85          57 0.4226923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 275     380.0          85          57 0.4242308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 276     381.5          85          57 0.4257692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 277     383.0          85          57 0.4273077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 278     386.0          85          57 0.4238462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 279     389.0          86          57 0.4253846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 280     390.5          86          57 0.4269231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 281     391.5          86          57 0.4284615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 282     393.0          86          56 0.4234615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 283     394.5          86          56 0.4184615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 284     396.0          86          56 0.4200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 285     397.5          86          56 0.4150000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 286     398.5          86          56 0.4165385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 287     399.5          86          56 0.4180769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 288     401.0          86          56 0.4196154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 289     403.0          87          56 0.4211538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 290     404.5          87          55 0.4161538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 291     406.0          87          55 0.4126923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 292     407.5          87          55 0.4142308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 293     409.5          87          54 0.4092308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 294     411.5          87          54 0.4107692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 295     412.5          87          54 0.4057692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 296     415.0          87          54 0.4088462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 297     417.5          88          54 0.4103846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 298     418.5          88          54 0.4119231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 299     421.0          88          54 0.4134615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 300     424.0          88          54 0.4150000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 301     425.5          88          54 0.4165385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 302     426.5          88          54 0.4180769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 303     427.5          88          54 0.4196154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 304     429.0          89          54 0.4211538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 305     430.5          89          54 0.4226923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 306     432.0          89          53 0.4176923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 307     435.5          89          52 0.4126923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 308     440.0          89          52 0.4076923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 309     445.0          89          52 0.4026923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 310     448.5          89          52 0.4042308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 311     450.0          89          51 0.3992308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 312     455.5          89          50 0.3942308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 313     461.0          89          50 0.3892308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 314     462.5          89          50 0.3842308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 315     463.5          89          50 0.3857692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 316     465.0          89          50 0.3873077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 317     467.0          89          48 0.3773077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 318     468.5          89          48 0.3723077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 319     470.5          89          48 0.3738462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 320     473.0          90          48 0.3753846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 321     475.0          90          48 0.3703846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 322     476.5          90          48 0.3734615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 323     477.5          90          48 0.3750000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 324     478.5          90          48 0.3765385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 325     482.0          90          48 0.3780769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 326     486.0          90          47 0.3730769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 327     492.0          90          47 0.3746154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 328     497.5          90          46 0.3696154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 329     498.5          90          46 0.3646154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 330     502.0          90          46 0.3596154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 331     507.5          90          44 0.3496154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 332     513.5          91          44 0.3461538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 333     518.0          91          44 0.3411538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 334     519.5          91          43 0.3376923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 335     521.5          91          42 0.3326923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 336     525.5          91          42 0.3276923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 337     530.5          91          42 0.3242308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 338     534.5          91          42 0.3257692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 339     536.5          91          42 0.3273077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 340     537.5          91          41 0.3223077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 341     541.5          91          40 0.3173077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 342     548.5          91          40 0.3188462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 343     555.5          91          40 0.3138462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 344     561.0          92          40 0.3169231</span>
<span class="r-in"><span><span class="va">distributions</span><span class="op">$</span><span class="va">Boxplot</span> <span class="co"># Boxplot</span></span></span>
<span class="r-plt img"><img src="markers_distribution-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ivan Ferrari, Riccardo L. Rossi, Saveria Mazzara.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

